# Configuration for Mac OS 9.1 on PowerPC - Maximum Performance
#
# PURPOSE: Optimized configuration for Mac OS 9.1 with fastest performance settings
# 
# KEY FEATURES:
# - Maximum performance settings (writeback cache, native AIO)
# - 512MB RAM optimized for Mac OS 9.1
# - G4 PowerPC processor emulation for best performance
# - User-mode networking for out-of-the-box connectivity
# 
# WHEN TO USE:
# - You want the fastest possible Mac OS 9.1 emulation
# - You need excellent compatibility with classic Mac software
# - You have a modern system with SSD storage
# - You want the best gaming and multimedia performance
# 
# PERFORMANCE: Maximum speed with all optimizations enabled
# COMPATIBILITY: Excellent with Mac OS 9.1 and classic Mac software
# RISK LEVEL: Low (save work frequently for maximum safety)

CONFIG_NAME="Mac OS 9.1 (Maximum Performance)"
ARCH="ppc"

# ========================================
# QEMU MACHINE CONFIGURATION
# ========================================

QEMU_MACHINE="mac99,via=pmu"            # Power Mac G3/G4 with PMU support (required for Mac OS 9/X)

# === CPU CONFIGURATION OPTIONS ===
# PowerPC CPU Models (fastest to most compatible):
# QEMU_CPU="g4"                         # PowerPC G4 (default, fastest, best Mac OS 9 support)
# QEMU_CPU="g3"                         # PowerPC G3 (compatible, slightly slower)
QEMU_CPU="g4"                           # Default: G4 for maximum performance

# === SMP CONFIGURATION ===
# SMP Core Options:
# QEMU_SMP_CORES="1"                    # Single core (default, Mac OS 9 doesn't support SMP)
# Note: Mac OS 9 does not support multiple processors effectively
QEMU_SMP_CORES="1"                      # Default: 1 core (Mac OS 9 limitation)

# === MEMORY CONFIGURATION OPTIONS ===
# RAM Sizes (PowerPC systems):
# QEMU_RAM="1024"                       # 1GB - Maximum for some software, may cause issues
# QEMU_RAM="512"                        # 512MB - Optimal for Mac OS 9.1 (default)
# QEMU_RAM="256"                        # 256MB - Minimum recommended for Mac OS 9
# QEMU_RAM="128"                        # 128MB - Absolute minimum, will be slow
QEMU_RAM="512"                          # Default: 512MB optimal for Mac OS 9.1

# ========================================
# PERFORMANCE TUNING CONFIGURATION
# ========================================

# === TCG THREADING OPTIONS ===
# Threading Modes (PowerPC-specific considerations):
# QEMU_TCG_THREAD_MODE="single"         # STABLE - Single-threaded TCG (default, PowerPC MTTCG has issues)
# QEMU_TCG_THREAD_MODE="multi"          # EXPERIMENTAL - Multi-threaded TCG (may cause instability on PowerPC)
# Note: PowerPC MTTCG support is not as mature as x86, single is recommended
QEMU_TCG_THREAD_MODE="single"           # Default: single for PowerPC stability

# === TRANSLATION BLOCK CACHE ===
# Cache Sizes (larger = faster, more memory):
# QEMU_TB_SIZE="1024"                   # EXTRA LARGE - 1GB cache (maximum performance, high memory)
# QEMU_TB_SIZE="512"                    # LARGE - 512MB cache (default, high performance)
# QEMU_TB_SIZE="256"                    # MEDIUM - 256MB cache (balanced)
# QEMU_TB_SIZE="128"                    # SMALL - 128MB cache (memory constrained)
QEMU_TB_SIZE="512"                      # Default: 512MB for PowerPC performance

# === MEMORY BACKEND OPTIONS ===
# Backend Types:
# QEMU_MEMORY_BACKEND="ram"             # Standard RAM backend (default)
# QEMU_MEMORY_BACKEND="file"            # File-backed memory (debugging)
QEMU_MEMORY_BACKEND="ram"               # Default: standard RAM backend

# ========================================
# STORAGE CONFIGURATION
# ========================================

# Main system disk image
QEMU_HDD="ppc/images/91/MacOS9.1.img"
# Shared disk for file transfer
QEMU_SHARED_HDD="ppc/images/91/shared_91.img"
# Optional: Custom disk sizes (uncomment to override defaults)
# QEMU_HDD_SIZE="10G"                   # Main OS disk size (default: script decides)
# QEMU_SHARED_HDD_SIZE="1G"             # Shared disk size (default: 200M)

# === IDE CACHE CONFIGURATION ===
# Cache Modes (fastest to safest):
# QEMU_IDE_CACHE_MODE="writeback"       # FASTEST - Memory buffered writes (default for max performance)
# QEMU_IDE_CACHE_MODE="writethrough"    # BALANCED - Write-through cache (safer)
# QEMU_IDE_CACHE_MODE="directsync"      # SAFE - Synchronous I/O (slower)
# QEMU_IDE_CACHE_MODE="none"            # SAFEST - No caching (slowest)
QEMU_IDE_CACHE_MODE="writeback"         # Default: writeback for maximum performance

# === IDE AIO CONFIGURATION ===
# AIO Modes (fastest to most compatible):
# QEMU_IDE_AIO_MODE="native"            # FASTEST - Linux kernel async I/O (default, Linux only)
# QEMU_IDE_AIO_MODE="threads"           # COMPATIBLE - Threaded I/O (all platforms)
QEMU_IDE_AIO_MODE="native"              # Default: native for maximum I/O performance

# ========================================
# DISPLAY CONFIGURATION
# ========================================

# === GRAPHICS RESOLUTION OPTIONS ===
# Display Resolutions (higher = more desktop space):
# QEMU_GRAPHICS="1024x768x32"           # HIGH - 1024x768, 32-bit color (maximum quality)
# QEMU_GRAPHICS="1024x768x16"           # HIGH - 1024x768, 16-bit color (balanced)
# QEMU_GRAPHICS="800x600x16"            # STANDARD - 800x600, 16-bit color (default)
# QEMU_GRAPHICS="800x600x8"             # STANDARD - 800x600, 8-bit color (faster)
# QEMU_GRAPHICS="640x480x16"            # CLASSIC - 640x480, 16-bit color
# QEMU_GRAPHICS="640x480x8"             # CLASSIC - 640x480, 8-bit color (period accurate)
QEMU_GRAPHICS="800x600x16"              # Default: 800x600x16 balanced for Mac OS 9

# === DISPLAY DEVICE OPTIONS ===
# Display Devices:
# QEMU_DISPLAY_DEVICE="built-in"        # Built-in display (default, fast)
# QEMU_DISPLAY_DEVICE="ati-vga"         # ATI VGA emulation (alternative)
QEMU_DISPLAY_DEVICE="built-in"          # Default: built-in for performance

# === DISPLAY RESOLUTION PRESETS ===
# Resolution Presets:
# QEMU_RESOLUTION_PRESET="mac_standard"  # Mac standard resolutions (default)
# QEMU_RESOLUTION_PRESET="vga"          # VGA standard resolutions
# QEMU_RESOLUTION_PRESET="svga"         # Super VGA resolutions
# QEMU_RESOLUTION_PRESET="xga"          # Extended Graphics Array
QEMU_RESOLUTION_PRESET="mac_standard"   # Default: Mac standard for authenticity

# ========================================
# AUDIO CONFIGURATION
# ========================================

# === AUDIO BACKEND OPTIONS ===
# Audio Backends (by platform):
# QEMU_AUDIO_BACKEND="pa"               # PulseAudio (Linux default)
# QEMU_AUDIO_BACKEND="coreaudio"        # CoreAudio (macOS)
# QEMU_AUDIO_BACKEND="dsound"           # DirectSound (Windows)
# QEMU_AUDIO_BACKEND="alsa"             # ALSA (Linux alternative)
# QEMU_AUDIO_BACKEND="sdl"              # SDL audio (cross-platform)
# QEMU_AUDIO_BACKEND="none"             # No audio output
QEMU_AUDIO_BACKEND="pa"                 # Default: PulseAudio for Linux

# === AUDIO LATENCY OPTIONS ===
# Audio Latency (microseconds - lower = less latency, higher CPU usage):
# QEMU_AUDIO_LATENCY="15000"            # LOW - 15ms (gaming/multimedia, high CPU)
# QEMU_AUDIO_LATENCY="25000"            # MEDIUM - 25ms (balanced, default)
# QEMU_AUDIO_LATENCY="35000"            # STANDARD - 35ms (efficient)
# QEMU_AUDIO_LATENCY="50000"            # HIGH - 50ms (compatibility mode)
QEMU_AUDIO_LATENCY="25000"              # Default: 25ms for good performance

# === SOUND DEVICE OPTIONS ===
# Sound Device Types:
# QEMU_SOUND_DEVICE="es1370"            # ES1370 sound card (default, excellent Mac OS 9 support)
# QEMU_SOUND_DEVICE="sb16"              # Sound Blaster 16 (alternative)
# QEMU_SOUND_DEVICE="ac97"              # AC97 audio (modern alternative)
QEMU_SOUND_DEVICE="es1370"              # Default: ES1370 for Mac OS 9

# ========================================
# NETWORKING CONFIGURATION
# ========================================

# === NETWORK DEVICE OPTIONS ===
# Network Devices:
# QEMU_NETWORK_DEVICE="virtio-net"      # VirtIO Network - A good default for PowerPC
# QEMU_NETWORK_DEVICE="rtl8139"         # RTL8139 - Good compatibility and performance
# QEMU_NETWORK_DEVICE="sungem"          # Sun GEM - Original PowerPC Mac default
# QEMU_NETWORK_DEVICE="e1000"           # Intel E1000 - Modern alternative
QEMU_NETWORK_DEVICE="sungem"        # Default: sungem for compatibility



# ========================================
# MAC OS 9.1 SPECIFIC FEATURES
# ========================================

# === MAC OS 9.1 ADVANTAGES ===
# Mac OS 9.1 is the final and most stable classic Mac OS, featuring:
# - Most stable classic Mac OS release
# - Excellent compatibility with classic Mac software
# - Superior gaming performance for classic Mac games
# - Enhanced networking stack with better TCP/IP support
# - Improved memory management
# - Better PowerPC optimization
# - Enhanced multimedia capabilities
# - Stable Carbon API support

# === RECOMMENDED SOFTWARE COMPATIBILITY ===
# Mac OS 9.1 is excellent for:
# - Classic Mac games (Unreal Tournament, Quake III Arena, etc.)
# - Productivity software (Microsoft Office 2001, AppleWorks 6)
# - Creative applications (Photoshop 7, Illustrator 10)
# - Development tools (CodeWarrior Pro 7, REALbasic)
# - Multimedia applications (QuickTime Pro, iTunes 2)
# - Classic Mac utilities and system tools

# === PERFORMANCE OPTIMIZATIONS FOR MAC OS 9 ===
# Mac OS 9.1 specific optimizations in this config:
# - 512MB RAM: Optimal for Mac OS 9.1 (more can cause issues)
# - G4 processor: Best performance and compatibility
# - ES1370 audio: Excellent Mac OS 9 support
# - sungem networking
# - Single TCG threading: Most stable for PowerPC emulation

# ========================================
# ADVANCED CONFIGURATION NOTES
# ========================================

# === PERFORMANCE vs SAFETY TRADE-OFFS ===
# This configuration prioritizes MAXIMUM PERFORMANCE with these trade-offs:
# 
# SPEED OPTIMIZATIONS:
# - writeback cache: Fastest disk I/O (requires clean VM shutdown)
# - native AIO: Linux kernel async I/O (Linux only, fastest)
# - 512MB RAM: Optimal memory for Mac OS 9.1
# - G4 processor: Fastest PowerPC emulation
# - sungem networking: Best network device ppc
#
# SAFETY CONSIDERATIONS:
# - Save work frequently when using writeback cache
# - Ensure clean VM shutdown to prevent data corruption
# - Single TCG threading for PowerPC stability
# - Native AIO requires Linux host for maximum performance

# === CUSTOMIZATION GUIDANCE ===
# To customize this configuration:
# 1. Uncomment and modify any setting above
# 2. For maximum safety: Change cache to "writethrough" and AIO to "threads"
# 3. For maximum speed: Keep current settings (already optimized)
# 4. For memory-constrained systems: Reduce QEMU_RAM to "256" (minimum)
# 5. For compatibility: Switch to "sungem" network device if needed

# === TROUBLESHOOTING ===
# If you experience issues:
# 1. Switch QEMU_IDE_CACHE_MODE to "writethrough" (safer)
# 2. Switch QEMU_IDE_AIO_MODE to "threads" (more compatible)
# 3. Reduce QEMU_RAM if experiencing memory-related issues
# 4. Switch QEMU_NETWORK_DEVICE to "sungem" for original compatibility
# 5. Try QEMU_CPU="g3" if G4 causes issues

# === MAC OS 9.1 INSTALLATION NOTES ===
# For installing Mac OS 9.1:
# 1. Create disk image: qemu-img create -f raw MacOS9.1.img 8G
# 2. Boot from CD: ./runmac.sh -C ppc-macos91.conf -c MacOS91.iso -b
# 3. Follow Mac OS 9.1 installation process
# 4. After installation: ./runmac.sh -C ppc-macos91.conf
# 5. Install Mac OS 9.1 updates for best compatibility